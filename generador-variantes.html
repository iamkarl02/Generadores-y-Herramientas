<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Variantes de Mobs</title>

    <link rel="icon" href="pikachu.png" type="image/png">

    <script src="https://cdn.jsdelivr.net/npm/react@17.0.2/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@17.0.2/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/babel-standalone@6.26.0/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            background: linear-gradient(135deg, #1a202c, #2d3748); 
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
        }
        .locked { background-color: #f56565; cursor: not-allowed; }
        .unlocked { background-color: #68d391; }
        .warning { color: #f56565; font-size: 0.9rem; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .tab-button.active {
            border-bottom-color: #4299e1;
            background-color: rgba(66, 153, 225, 0.1);
        }
        .variant-tab {
            background: rgba(45, 55, 72, 0.7);
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        .variant-tab:hover {
            background: rgba(45, 55, 72, 0.9);
            transform: translateY(-2px);
        }
        .variant-tab.active {
            background: rgba(66, 153, 225, 0.2);
            border-left: 3px solid #4299e1;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .accordion-content.open {
            max-height: 2000px;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #2d3748;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 3px;
        }
        .mobile-menu-button {
            display: none;
        }
        @media (max-width: 768px) {
            .mobile-menu-button {
                display: block;
            }
            .tab-buttons {
                flex-direction: column;
            }
            .tab-button {
                width: 100%;
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const validMobs = ['zombie', 'skeleton', 'creeper', 'enderman', 'husk', 'drowned', 'spider', 'cave_spider', 'wither_skeleton'];
        const validEffects = ['speed', 'slowness', 'strength', 'weakness', 'resistance', 'regeneration', 'invisibility', 'jump_boost', 'fire_resistance', 'water_breathing', 'poison', 'wither', 'hunger', 'nausea', 'blindness', 'mining_fatigue', 'levitation', 'unluck'];
        const validItems = ['diamond_sword', 'iron_sword', 'stone_sword', 'wooden_sword', 'golden_sword', 'netherite_sword', 'bow', 'crossbow', 'trident', 'stick', 'tnt', 'totem_of_undying', 'shield'];
        const validArmor = ['leather_helmet', 'leather_chestplate', 'leather_leggings', 'leather_boots', 'iron_helmet', 'iron_chestplate', 'iron_leggings', 'iron_boots', 'diamond_helmet', 'diamond_chestplate', 'diamond_leggings', 'diamond_boots', 'netherite_helmet', 'netherite_chestplate', 'netherite_leggings', 'netherite_boots', 'turtle_helmet'];
        const validEnchantments = ['protection', 'fire_protection', 'blast_protection', 'projectile_protection', 'thorns', 'sharpness', 'knockback', 'fire_aspect', 'looting', 'unbreaking'];

        const App = () => {
            const [mobType, setMobType] = useState('zombie');
            const [variantCount, setVariantCount] = useState(1);
            const [variants, setVariants] = useState([createNewVariant(1)]);
            const [isMobile, setIsMobile] = useState(false);
            const [unlockTags, setUnlockTags] = useState(false);
            const [unlockEffects, setUnlockEffects] = useState(false);
            const [advancedCommand, setAdvancedCommand] = useState('');
            const [showWarnings, setShowWarnings] = useState(true);
            const [activeTab, setActiveTab] = useState('general');
            const [activeVariant, setActiveVariant] = useState(0);
            const [openAccordion, setOpenAccordion] = useState({
                name: true,
                armor: true,
                items: true,
                effects: true,
                tags: true
            });
            const [showMobileMenu, setShowMobileMenu] = useState(false);

            function createNewVariant(id) {
                const mobPrefix = mobType.includes('_') ? mobType.split('_')[0] : mobType;
                return {
                    id,
                    name: '',
                    nameColors: [{ letter: '', color: '#ffffff', bold: true, italic: false }],
                    armor: { head: '', chest: '', legs: '', feet: '' },
                    armorColors: { head: '#ffffff', chest: '#ffffff', legs: '#ffffff', feet: '#ffffff' },
                    items: { mainHand: '', offHand: '' },
                    enchantments: { head: [], chest: [], legs: [], feet: [], mainHand: [], offHand: [] },
                    effects: [{ name: 'speed', duration: mobType === 'creeper' ? 1 : 999999, amplifier: 1 }],
                    customModelData: 100,
                    nameVisibleDistance: 60,
                    tag: `${mobPrefix}_c${id}`,
                    readyTag: `${mobPrefix}_r${id}`
                };
            }

            useEffect(() => {
                const handleResize = () => {
                    const mobile = window.innerWidth <= 768;
                    setIsMobile(mobile);
                    if (!mobile) setShowMobileMenu(false);
                };
                handleResize();
                window.addEventListener('resize', handleResize);
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            useEffect(() => {
                setVariants(prev => {
                    const newVariants = [];
                    for (let i = 0; i < prev.length; i++) {
                        const mobPrefix = mobType.includes('_') ? mobType.split('_')[0] : mobType;
                        newVariants.push({
                            ...prev[i],
                            tag: prev[i].tag.startsWith(prev[i].tag.split('_')[0] + '_') ? 
                                `${mobPrefix}_${prev[i].tag.split('_')[1]}` : 
                                `${mobPrefix}_c${i+1}`,
                            readyTag: prev[i].readyTag.startsWith(prev[i].readyTag.split('_')[0] + '_') ? 
                                `${mobPrefix}_${prev[i].readyTag.split('_')[1]}` : 
                                `${mobPrefix}_r${i+1}`,
                            effects: prev[i].effects.map(effect => ({
                                ...effect,
                                duration: mobType === 'creeper' ? 1 : effect.duration
                            }))
                        });
                    }
                    return newVariants;
                });
            }, [mobType]);

            const updateVariantCount = (count) => {
                count = Math.max(1, Math.min(100, parseInt(count) || 1));
                setVariantCount(count);
                setVariants(prev => {
                    const newVariants = prev.slice(0, count);
                    for (let i = prev.length; i < count; i++) {
                        newVariants.push(createNewVariant(i+1));
                    }
                    return newVariants;
                });
            };

            const updateVariant = (index, field, value) => {
                setVariants(prev => {
                    const newVariants = [...prev];
                    newVariants[index] = { ...newVariants[index], [field]: value };
                    if (field === 'name') {
                        newVariants[index].nameColors = value.split('').map(letter => ({
                            letter,
                            color: '#ffffff',
                            bold: true,
                            italic: false
                        }));
                    }
                    return newVariants;
                });
            };

            const addEffect = (index) => {
                setVariants(prev => {
                    const newVariants = [...prev];
                    newVariants[index].effects.push({ 
                        name: 'speed', 
                        duration: mobType === 'creeper' ? 1 : 999999, 
                        amplifier: 1 
                    });
                    return newVariants;
                });
            };

            const updateEffect = (variantIndex, effectIndex, field, value) => {
                setVariants(prev => {
                    const newVariants = [...prev];
                    newVariants[variantIndex].effects[effectIndex] = {
                        ...newVariants[variantIndex].effects[effectIndex],
                        [field]: field === 'amplifier' ? Math.min(255, Math.max(0, parseInt(value) || 0)) : value
                    };
                    return newVariants;
                });
            };

            const removeEffect = (variantIndex, effectIndex) => {
                setVariants(prev => {
                    const newVariants = [...prev];
                    newVariants[variantIndex].effects = newVariants[variantIndex].effects.filter((_, i) => i !== effectIndex);
                    return newVariants;
                });
            };

            const addEnchantment = (variantIndex, slot) => {
                setVariants(prev => {
                    const newVariants = [...prev];
                    newVariants[variantIndex].enchantments[slot].push({ id: 'protection', level: 1 });
                    return newVariants;
                });
            };

            const updateEnchantment = (variantIndex, slot, enchantIndex, field, value) => {
                setVariants(prev => {
                    const newVariants = [...prev];
                    newVariants[variantIndex].enchantments[slot][enchantIndex] = {
                        ...newVariants[variantIndex].enchantments[slot][enchantIndex],
                        [field]: field === 'level' ? Math.min(255, Math.max(0, parseInt(value) || 0)) : value
                    };
                    return newVariants;
                });
            };

            const removeEnchantment = (variantIndex, slot, enchantIndex) => {
                setVariants(prev => {
                    const newVariants = [...prev];
                    newVariants[variantIndex].enchantments[slot] = newVariants[variantIndex].enchantments[slot].filter((_, i) => i !== enchantIndex);
                    return newVariants;
                });
            };

            const toggleAccordion = (section) => {
                setOpenAccordion(prev => ({
                    ...prev,
                    [section]: !prev[section]
                }));
            };

            const generateDatapack = () => {
                if (!mobType || variants.some(v => !v.name)) {
                    alert('Por favor, completa el tipo de mob y los nombres de todas las variantes.');
                    return;
                }

                const mobPrefix = mobType.includes('_') ? mobType.split('_')[0] : mobType;
                let commands = [
                    `# Generador de Variantes de Mobs - Creado por Carlos`,
                    `# Compatible con Minecraft 1.16.5`,
                    `# Este archivo (tick.mcfunction) se ejecuta cada tick`,
                    '',
                    `# Limpiar items con CustomModelData:100`,
                    `kill @e[type=item,nbt={Item:{tag:{CustomModelData:100}}}]`,
                    '',
                    `# Configurar scoreboard`,
                    `scoreboard objectives add ${mobPrefix}c dummy`,
                    '',
                    `# Asignar tag base a los mobs`,
                    `execute as @e[type=${mobType}] run tag @s add ${mobPrefix}`,
                    '',
                    `# Contador para asignar variantes`,
                    `execute as @e[tag=${mobPrefix},tag=!${mobPrefix}c] run scoreboard players add ${mobPrefix}c ${mobPrefix}c 1`,
                    `execute as @e[tag=${mobPrefix},tag=!${mobPrefix}c] run tag @s add ${mobPrefix}c`,
                    '',
                    `# Asignar tags a las variantes`
                ];

                // Generar la lista de tags a excluir para todas las variantes
                const excludeTags = variants.map(v => `tag=!${v.tag}`).join(',');

                variants.forEach((variant, index) => {
                    commands.push(`execute if score ${mobPrefix}c ${mobPrefix}c matches ${index + 1} run execute as @e[tag=${mobPrefix},${excludeTags},limit=1,sort=random] run tag @s add ${variant.tag}`);
                    commands.push('');
                });

                variants.forEach((variant, index) => {
                    commands.push(`# Variante ${index + 1}: ${variant.name}`);
                    commands.push('');
                    
                    // Armadura y items (siempre se aplican solo una vez con tag=!ready)
                    if (variant.armor.head) {
                        const color = variant.armor.head.includes('leather') ? `,display:{color:${parseInt(variant.armorColors.head.replace('#', ''), 16)}}` : '';
                        const enchantments = variant.enchantments.head.map(e => `{id:"minecraft:${e.id}",lvl:${e.level}}`).join(',');
                        commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run replaceitem entity @s armor.head minecraft:${variant.armor.head}{CustomModelData:${variant.customModelData},Unbreakable:1b${color}${enchantments ? `,Enchantments:[${enchantments}]` : ''}}`);
                        commands.push('');
                    }
                    
                    if (variant.armor.chest) {
                        const color = variant.armor.chest.includes('leather') ? `,display:{color:${parseInt(variant.armorColors.chest.replace('#', ''), 16)}}` : '';
                        const enchantments = variant.enchantments.chest.map(e => `{id:"minecraft:${e.id}",lvl:${e.level}}`).join(',');
                        commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run replaceitem entity @s armor.chest minecraft:${variant.armor.chest}{CustomModelData:${variant.customModelData},Unbreakable:1b${color}${enchantments ? `,Enchantments:[${enchantments}]` : ''}}`);
                        commands.push('');
                    }
                    
                    if (variant.armor.legs) {
                        const color = variant.armor.legs.includes('leather') ? `,display:{color:${parseInt(variant.armorColors.legs.replace('#', ''), 16)}}` : '';
                        const enchantments = variant.enchantments.legs.map(e => `{id:"minecraft:${e.id}",lvl:${e.level}}`).join(',');
                        commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run replaceitem entity @s armor.legs minecraft:${variant.armor.legs}{CustomModelData:${variant.customModelData},Unbreakable:1b${color}${enchantments ? `,Enchantments:[${enchantments}]` : ''}}`);
                        commands.push('');
                    }
                    
                    if (variant.armor.feet) {
                        const color = variant.armor.feet.includes('leather') ? `,display:{color:${parseInt(variant.armorColors.feet.replace('#', ''), 16)}}` : '';
                        const enchantments = variant.enchantments.feet.map(e => `{id:"minecraft:${e.id}",lvl:${e.level}}`).join(',');
                        commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run replaceitem entity @s armor.feet minecraft:${variant.armor.feet}{CustomModelData:${variant.customModelData},Unbreakable:1b${color}${enchantments ? `,Enchantments:[${enchantments}]` : ''}}`);
                        commands.push('');
                    }

                    // Items
                    if (variant.items.mainHand) {
                        const enchantments = variant.enchantments.mainHand.map(e => `{id:"minecraft:${e.id}",lvl:${e.level}}`).join(',');
                        commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run replaceitem entity @s weapon.mainhand minecraft:${variant.items.mainHand}{CustomModelData:${variant.customModelData},Unbreakable:1b${enchantments ? `,Enchantments:[${enchantments}]` : ''}}`);
                        commands.push('');
                    }
                    
                    if (variant.items.offHand) {
                        const enchantments = variant.enchantments.offHand.map(e => `{id:"minecraft:${e.id}",lvl:${e.level}}`).join(',');
                        commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run replaceitem entity @s weapon.offhand minecraft:${variant.items.offHand}{CustomModelData:${variant.customModelData},Unbreakable:1b${enchantments ? `,Enchantments:[${enchantments}]` : ''}}`);
                        commands.push('');
                    }

                    // Nombre
                    const nameJson = variant.nameColors.map(c => `{"text":"${c.letter}","color":"${c.color}","bold":${c.bold},"italic":${c.italic}}`).join(',');
                    commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run data merge entity @s {CustomName:'{"text":"","extra":[${nameJson}]}',CustomNameVisible:1b}`);
                    commands.push('');

                    // Visibilidad del nombre (se aplica continuamente)
                    commands.push(`execute as @e[tag=${variant.tag}] at @s unless entity @a[distance=..${variant.nameVisibleDistance}] run data merge entity @s {CustomNameVisible:0b}`);
                    commands.push(`execute as @e[tag=${variant.tag}] at @s if entity @a[distance=..${variant.nameVisibleDistance}] run data merge entity @s {CustomNameVisible:1b}`);
                    commands.push('');

                    // Efectos (comportamiento diferente para creepers)
                    variant.effects.forEach(effect => {
                        if (mobType === 'creeper') {
                            // Para creepers, aplicar efectos continuamente
                            commands.push(`execute as @e[tag=${variant.tag}] run effect give @s ${effect.name} ${effect.duration} ${effect.amplifier} true`);
                        } else {
                            // Para otros mobs, aplicar efectos solo una vez
                            commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run effect give @s ${effect.name} ${effect.duration} ${effect.amplifier} true`);
                        }
                        commands.push('');
                    });

                    // Comando avanzado
                    if (advancedCommand) {
                        commands.push(`# Comando Avanzado para Variante ${index + 1}`);
                        commands.push(advancedCommand);
                        commands.push('');
                    }

                    // Agregar tag ready para todos los mobs (incluyendo creepers) después de aplicar armadura/items
                    commands.push(`execute as @e[tag=${variant.tag},tag=!${variant.readyTag}] run tag @s add ${variant.readyTag}`);
                    commands.push('');
                });

                // Reiniciar contador (como último comando)
                commands.push(`# Reiniciar contador`);
                commands.push(`execute if score ${mobPrefix}c ${mobPrefix}c matches ${variantCount + 1}.. run scoreboard players set ${mobPrefix}c ${mobPrefix}c 1`);

                const blob = new Blob([commands.join('\n')], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'tick.mcfunction';
                a.click();
                URL.revokeObjectURL(url);
            };

            const goToIndex = () => {
                window.location.href = 'index.html';
            };

            const toggleMobileMenu = () => {
                setShowMobileMenu(!showMobileMenu);
            };

            return (
                <div className="container mx-auto p-4 text-white max-w-7xl">
                    <header className="mb-8 text-center">
                        <div className="flex justify-between items-center">
                            <button 
                                onClick={goToIndex}
                                className="px-4 py-2 bg-blue-600 rounded hover:bg-blue-700"
                            >
                                Volver al Index
                            </button>
                            <button 
                                onClick={toggleMobileMenu}
                                className="mobile-menu-button px-4 py-2 bg-blue-600 rounded hover:bg-blue-700"
                            >
                                Menú
                            </button>
                        </div>
                        <h1 className="text-4xl font-bold mb-2 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-green-400">
                            Generador de Variantes de Mobs
                        </h1>
                        <p className="text-gray-300">Creado por Carlos - Compatible con Minecraft 1.16.5</p>
                    </header>

                    <div className="flex flex-col lg:flex-row gap-6">
                        {/* Sidebar con pestañas de variantes */}
                        <div className="w-full lg:w-1/4">
                            <div className="bg-gray-800 rounded-lg shadow-lg p-4 mb-4">
                                <h2 className="text-xl font-semibold mb-4">Variantes</h2>
                                <div className="space-y-2 max-h-96 overflow-y-auto custom-scrollbar">
                                    {variants.map((variant, index) => (
                                        <div 
                                            key={variant.id}
                                            className={`variant-tab p-3 cursor-pointer ${activeVariant === index ? 'active' : ''}`}
                                            onClick={() => {
                                                setActiveVariant(index);
                                                if (isMobile) setShowMobileMenu(false);
                                            }}
                                        >
                                            <div className="flex justify-between items-center">
                                                <span className="font-medium">
                                                    Variante {index + 1}: {variant.name || <span className="text-gray-400">Sin nombre</span>}
                                                </span>
                                                <span className="bg-blue-600 text-xs px-2 py-1 rounded-full">
                                                    {index + 1}
                                                </span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                <div className="mt-4">
                                    <label className="block mb-2">
                                        Número de Variantes (1-100):
                                        <input
                                            type="number"
                                            min="1"
                                            max="100"
                                            value={variantCount}
                                            onChange={(e) => updateVariantCount(e.target.value)}
                                            className="mt-1 block w-full p-2 bg-gray-700 rounded text-white"
                                        />
                                    </label>
                                </div>
                            </div>
                        </div>

                        {/* Contenido principal */}
                        <div className="w-full lg:w-3/4">
                            {/* Pestañas de navegación */}
                            <div className={`flex border-b border-gray-700 mb-6 ${isMobile ? 'flex-col' : ''} ${showMobileMenu ? 'block' : 'hidden lg:flex'}`}>
                                <button
                                    className={`tab-button px-4 py-2 font-medium ${activeTab === 'general' ? 'active' : ''}`}
                                    onClick={() => {
                                        setActiveTab('general');
                                        if (isMobile) setShowMobileMenu(false);
                                    }}
                                >
                                    General
                                </button>
                                <button
                                    className={`tab-button px-4 py-2 font-medium ${activeTab === 'variants' ? 'active' : ''}`}
                                    onClick={() => {
                                        setActiveTab('variants');
                                        if (isMobile) setShowMobileMenu(false);
                                    }}
                                >
                                    Configurar Variante {activeVariant + 1}
                                </button>
                                <button
                                    className={`tab-button px-4 py-2 font-medium ${activeTab === 'advanced' ? 'active' : ''}`}
                                    onClick={() => {
                                        setActiveTab('advanced');
                                        if (isMobile) setShowMobileMenu(false);
                                    }}
                                >
                                    Avanzado
                                </button>
                                <button
                                    className={`tab-button px-4 py-2 font-medium ${activeTab === 'instructions' ? 'active' : ''}`}
                                    onClick={() => {
                                        setActiveTab('instructions');
                                        if (isMobile) setShowMobileMenu(false);
                                    }}
                                >
                                    Instrucciones
                                </button>
                            </div>

                            {/* Contenido de pestañas */}
                            <div className="tab-content-container">
                                {/* Pestaña General */}
                                <div className={`tab-content ${activeTab === 'general' ? 'active' : ''}`}>
                                    <div className="bg-gray-800 rounded-lg shadow-lg p-6 mb-6">
                                        <h2 className="text-2xl font-semibold mb-4">Configuración General</h2>
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block mb-2">
                                                    Tipo de Mob:
                                                    <input
                                                        type="text"
                                                        value={mobType}
                                                        onChange={(e) => setMobType(e.target.value.toLowerCase())}
                                                        className="mt-1 block w-full p-2 bg-gray-700 rounded text-white"
                                                        placeholder="Ej: zombie, skeleton, creeper..."
                                                        list="mobTypes"
                                                    />
                                                    <datalist id="mobTypes">
                                                        {validMobs.map(mob => <option key={mob} value={mob} />)}
                                                    </datalist>
                                                </label>
                                            </div>

                                            <div className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    checked={unlockTags}
                                                    onChange={() => setUnlockTags(!unlockTags)}
                                                    className="mr-2"
                                                />
                                                <span>Desbloquear edición de Tags</span>
                                            </div>

                                            <div className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    checked={unlockEffects}
                                                    onChange={() => setUnlockEffects(!unlockEffects)}
                                                    className="mr-2"
                                                />
                                                <span>Desbloquear edición manual de efectos</span>
                                            </div>

                                            <div className="flex items-center">
                                                <input
                                                    type="checkbox"
                                                    checked={showWarnings}
                                                    onChange={() => setShowWarnings(!showWarnings)}
                                                    className="mr-2"
                                                />
                                                <span>Mostrar advertencias</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Pestaña Variantes */}
                                <div className={`tab-content ${activeTab === 'variants' ? 'active' : ''}`}>
                                    {variants.length > 0 && (
                                        <div className="bg-gray-800 rounded-lg shadow-lg p-6">
                                            <h2 className="text-2xl font-semibold mb-4">Configuración de Variante {activeVariant + 1}</h2>
                                            
                                            {/* Nombre y colores */}
                                            <div className="mb-6">
                                                <div 
                                                    className="flex justify-between items-center cursor-pointer mb-2"
                                                    onClick={() => toggleAccordion('name')}
                                                >
                                                    <h3 className="text-xl font-semibold">Nombre y Apariencia</h3>
                                                    <span>{openAccordion.name ? '▼' : '▶'}</span>
                                                </div>
                                                <div className={`accordion-content ${openAccordion.name ? 'open' : ''}`}>
                                                    <label className="block mb-4">
                                                        Nombre de la Variante:
                                                        <input
                                                            type="text"
                                                            value={variants[activeVariant].name}
                                                            onChange={(e) => updateVariant(activeVariant, 'name', e.target.value)}
                                                            className="mt-1 block w-full p-2 bg-gray-700 rounded text-white"
                                                            placeholder="Ej: Zombie Infernal"
                                                        />
                                                    </label>

                                                    <label className="block mb-4">
                                                        Distancia de Visibilidad del Nombre:
                                                        <input
                                                            type="number"
                                                            value={variants[activeVariant].nameVisibleDistance}
                                                            onChange={(e) => updateVariant(activeVariant, 'nameVisibleDistance', e.target.value)}
                                                            className="mt-1 block w-full p-2 bg-gray-700 rounded text-white"
                                                            min="1"
                                                            max="100"
                                                        />
                                                    </label>

                                                    <div className="mb-4">
                                                        <h4 className="font-medium mb-2">Colores del Nombre:</h4>
                                                        <div className="grid grid-cols-2 sm:grid-cols-4 gap-2">
                                                            {variants[activeVariant].nameColors.map((color, i) => (
                                                                <div key={i} className="flex items-center p-2 bg-gray-700 rounded">
                                                                    <input
                                                                        type="text"
                                                                        value={color.letter}
                                                                        disabled
                                                                        className="w-8 p-1 bg-gray-600 rounded mr-2 text-center"
                                                                    />
                                                                    <input
                                                                        type="color"
                                                                        value={color.color}
                                                                        onChange={(e) => {
                                                                            const newColors = [...variants[activeVariant].nameColors];
                                                                            newColors[i].color = e.target.value;
                                                                            updateVariant(activeVariant, 'nameColors', newColors);
                                                                        }}
                                                                        className="mr-2"
                                                                    />
                                                                    <label className="mr-2 flex items-center">
                                                                        <input
                                                                            type="checkbox"
                                                                            checked={color.bold}
                                                                            onChange={() => {
                                                                                const newColors = [...variants[activeVariant].nameColors];
                                                                                newColors[i].bold = !newColors[i].bold;
                                                                                updateVariant(activeVariant, 'nameColors', newColors);
                                                                            }}
                                                                            className="mr-1"
                                                                        />
                                                                        <span className="text-xs">B</span>
                                                                    </label>
                                                                    <label className="flex items-center">
                                                                        <input
                                                                            type="checkbox"
                                                                            checked={color.italic}
                                                                            onChange={() => {
                                                                                const newColors = [...variants[activeVariant].nameColors];
                                                                                newColors[i].italic = !newColors[i].italic;
                                                                                updateVariant(activeVariant, 'nameColors', newColors);
                                                                            }}
                                                                            className="mr-1"
                                                                        />
                                                                        <span className="text-xs">I</span>
                                                                    </label>
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Armadura */}
                                            <div className="mb-6">
                                                <div 
                                                    className="flex justify-between items-center cursor-pointer mb-2"
                                                    onClick={() => toggleAccordion('armor')}
                                                >
                                                    <h3 className="text-xl font-semibold">Armadura</h3>
                                                    <span>{openAccordion.armor ? '▼' : '▶'}</span>
                                                </div>
                                                <div className={`accordion-content ${openAccordion.armor ? 'open' : ''}`}>
                                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                        {['head', 'chest', 'legs', 'feet'].map(slot => (
                                                            <div key={slot} className="bg-gray-700 p-3 rounded">
                                                                <label className="block mb-2">
                                                                    {slot.charAt(0).toUpperCase() + slot.slice(1)}:
                                                                    <input
                                                                        type="text"
                                                                        value={variants[activeVariant].armor[slot]}
                                                                        onChange={(e) => {
                                                                            const newArmor = { ...variants[activeVariant].armor, [slot]: e.target.value };
                                                                            updateVariant(activeVariant, 'armor', newArmor);
                                                                        }}
                                                                        className="mt-1 block w-full p-2 bg-gray-600 rounded text-white"
                                                                        placeholder={`Ej: ${validArmor[0]}`}
                                                                        list={`armor${slot}`}
                                                                    />
                                                                    <datalist id={`armor${slot}`}>
                                                                        {validArmor.map(item => <option key={item} value={item} />)}
                                                                    </datalist>
                                                                    {variants[activeVariant].armor[slot].includes('leather') && (
                                                                        <div className="mt-2 flex items-center">
                                                                            <span className="mr-2">Color:</span>
                                                                            <input
                                                                                type="color"
                                                                                value={variants[activeVariant].armorColors[slot]}
                                                                                onChange={(e) => {
                                                                                    const newColors = { ...variants[activeVariant].armorColors, [slot]: e.target.value };
                                                                                    updateVariant(activeVariant, 'armorColors', newColors);
                                                                                }}
                                                                            />
                                                                        </div>
                                                                    )}
                                                                </label>

                                                                <div className="mt-2">
                                                                    <h4 className="font-medium mb-1">Encantamientos:</h4>
                                                                    {variants[activeVariant].enchantments[slot].length === 0 ? (
                                                                        <p className="text-gray-400 text-sm">No hay encantamientos</p>
                                                                    ) : (
                                                                        <div className="space-y-2">
                                                                            {variants[activeVariant].enchantments[slot].map((enchant, i) => (
                                                                                <div key={i} className="flex items-center">
                                                                                    <input
                                                                                        type="text"
                                                                                        value={enchant.id}
                                                                                        onChange={(e) => updateEnchantment(activeVariant, slot, i, 'id', e.target.value)}
                                                                                        className="flex-1 p-1 bg-gray-600 rounded text-white mr-2"
                                                                                        list="enchantments"
                                                                                    />
                                                                                    <input
                                                                                        type="number"
                                                                                        value={enchant.level}
                                                                                        onChange={(e) => updateEnchantment(activeVariant, slot, i, 'level', e.target.value)}
                                                                                        className="w-16 p-1 bg-gray-600 rounded text-white mr-2"
                                                                                        min="0"
                                                                                        max="255"
                                                                                    />
                                                                                    <button
                                                                                        onClick={() => removeEnchantment(activeVariant, slot, i)}
                                                                                        className="px-2 py-1 bg-red-600 rounded text-sm"
                                                                                    >
                                                                                        X
                                                                                    </button>
                                                                                </div>
                                                                            ))}
                                                                        </div>
                                                                    )}
                                                                    <button
                                                                        onClick={() => addEnchantment(activeVariant, slot)}
                                                                        className="mt-2 px-3 py-1 bg-green-600 rounded text-sm"
                                                                    >
                                                                        + Añadir Encantamiento
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Items */}
                                            <div className="mb-6">
                                                <div 
                                                    className="flex justify-between items-center cursor-pointer mb-2"
                                                    onClick={() => toggleAccordion('items')}
                                                >
                                                    <h3 className="text-xl font-semibold">Items</h3>
                                                    <span>{openAccordion.items ? '▼' : '▶'}</span>
                                                </div>
                                                <div className={`accordion-content ${openAccordion.items ? 'open' : ''}`}>
                                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                        {['mainHand', 'offHand'].map(slot => (
                                                            <div key={slot} className="bg-gray-700 p-3 rounded">
                                                                <label className="block mb-2">
                                                                    {slot === 'mainHand' ? 'Mano Principal' : 'Mano Secundaria'}:
                                                                    <input
                                                                        type="text"
                                                                        value={variants[activeVariant].items[slot]}
                                                                        onChange={(e) => {
                                                                            const newItems = { ...variants[activeVariant].items, [slot]: e.target.value };
                                                                            updateVariant(activeVariant, 'items', newItems);
                                                                        }}
                                                                        className="mt-1 block w-full p-2 bg-gray-600 rounded text-white"
                                                                        placeholder={`Ej: ${validItems[0]}`}
                                                                        list="items"
                                                                    />
                                                                    <datalist id="items">
                                                                        {validItems.map(item => <option key={item} value={item} />)}
                                                                    </datalist>
                                                                </label>

                                                                <div className="mt-2">
                                                                    <h4 className="font-medium mb-1">Encantamientos:</h4>
                                                                    {variants[activeVariant].enchantments[slot].length === 0 ? (
                                                                        <p className="text-gray-400 text-sm">No hay encantamientos</p>
                                                                    ) : (
                                                                        <div className="space-y-2">
                                                                            {variants[activeVariant].enchantments[slot].map((enchant, i) => (
                                                                                <div key={i} className="flex items-center">
                                                                                    <input
                                                                                        type="text"
                                                                                        value={enchant.id}
                                                                                        onChange={(e) => updateEnchantment(activeVariant, slot, i, 'id', e.target.value)}
                                                                                        className="flex-1 p-1 bg-gray-600 rounded text-white mr-2"
                                                                                        list="enchantments"
                                                                                    />
                                                                                    <input
                                                                                        type="number"
                                                                                        value={enchant.level}
                                                                                        onChange={(e) => updateEnchantment(activeVariant, slot, i, 'level', e.target.value)}
                                                                                        className="w-16 p-1 bg-gray-600 rounded text-white mr-2"
                                                                                        min="0"
                                                                                        max="255"
                                                                                    />
                                                                                    <button
                                                                                        onClick={() => removeEnchantment(activeVariant, slot, i)}
                                                                                        className="px-2 py-1 bg-red-600 rounded text-sm"
                                                                                    >
                                                                                        X
                                                                                    </button>
                                                                                </div>
                                                                            ))}
                                                                        </div>
                                                                    )}
                                                                    <button
                                                                        onClick={() => addEnchantment(activeVariant, slot)}
                                                                        className="mt-2 px-3 py-1 bg-green-600 rounded text-sm"
                                                                    >
                                                                        + Añadir Encantamiento
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Efectos */}
                                            <div className="mb-6">
                                                <div 
                                                    className="flex justify-between items-center cursor-pointer mb-2"
                                                    onClick={() => toggleAccordion('effects')}
                                                >
                                                    <h3 className="text-xl font-semibold">Efectos</h3>
                                                    <span>{openAccordion.effects ? '▼' : '▶'}</span>
                                                </div>
                                                <div className={`accordion-content ${openAccordion.effects ? 'open' : ''}`}>
                                                    {showWarnings && (
                                                        <div className="bg-yellow-900 text-yellow-200 p-3 rounded mb-4">
                                                            <p className="text-sm">
                                                                ⚠️ {mobType === 'creeper' ? 'Para creepers, los efectos se aplicarán continuamente cada tick' : 'Duración recomendada: 999999'}. Amplificador máximo: 255 (en el juego, nivel = amplificador + 1).
                                                            </p>
                                                        </div>
                                                    )}

                                                    <div className="space-y-3">
                                                        {variants[activeVariant].effects.map((effect, i) => (
                                                            <div key={i} className="bg-gray-700 p-3 rounded">
                                                                <div className="grid grid-cols-1 md:grid-cols-4 gap-3">
                                                                    <div>
                                                                        <label className="block text-sm font-medium mb-1">Efecto</label>
                                                                        <input
                                                                            type="text"
                                                                            value={effect.name}
                                                                            onChange={(e) => updateEffect(activeVariant, i, 'name', e.target.value)}
                                                                            className={`w-full p-2 rounded text-white ${unlockEffects ? 'bg-gray-600' : 'bg-red-700 cursor-not-allowed'}`}
                                                                            disabled={!unlockEffects}
                                                                            list="effects"
                                                                        />
                                                                    </div>
                                                                    <div>
                                                                        <label className="block text-sm font-medium mb-1">Duración</label>
                                                                        <input
                                                                            type="number"
                                                                            value={effect.duration}
                                                                            onChange={(e) => updateEffect(activeVariant, i, 'duration', e.target.value)}
                                                                            className="w-full p-2 bg-gray-600 rounded text-white"
                                                                            min="1"
                                                                            max={mobType === 'creeper' ? 1 : 999999}
                                                                        />
                                                                    </div>
                                                                    <div>
                                                                        <label className="block text-sm font-medium mb-1">Amplificador</label>
                                                                        <input
                                                                            type="number"
                                                                            value={effect.amplifier}
                                                                            onChange={(e) => updateEffect(activeVariant, i, 'amplifier', e.target.value)}
                                                                            className="w-full p-2 bg-gray-600 rounded text-white"
                                                                            min="0"
                                                                            max="255"
                                                                        />
                                                                    </div>
                                                                    <div className="flex items-end">
                                                                        <button
                                                                            onClick={() => removeEffect(activeVariant, i)}
                                                                            className="w-full py-2 bg-red-600 rounded hover:bg-red-700"
                                                                        >
                                                                            Eliminar
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>

                                                    <datalist id="effects">
                                                        {validEffects.map(effect => <option key={effect} value={effect} />)}
                                                    </datalist>

                                                    <button
                                                        onClick={() => addEffect(activeVariant)}
                                                        className="mt-3 px-4 py-2 bg-green-600 rounded hover:bg-green-700 w-full"
                                                    >
                                                        + Añadir Efecto
                                                    </button>
                                                </div>
                                            </div>

                                            {/* Tags */}
                                            <div>
                                                <div 
                                                    className="flex justify-between items-center cursor-pointer mb-2"
                                                    onClick={() => toggleAccordion('tags')}
                                                >
                                                    <h3 className="text-xl font-semibold">Tags</h3>
                                                    <span>{openAccordion.tags ? '▼' : '▶'}</span>
                                                </div>
                                                <div className={`accordion-content ${openAccordion.tags ? 'open' : ''}`}>
                                                    <div className="space-y-4">
                                                        <label className="block">
                                                            Tag de la Variante:
                                                            <input
                                                                type="text"
                                                                value={variants[activeVariant].tag}
                                                                onChange={(e) => updateVariant(activeVariant, 'tag', e.target.value)}
                                                                className={`mt-1 block w-full p-2 rounded text-white ${unlockTags ? 'bg-gray-700' : 'bg-red-700 cursor-not-allowed'}`}
                                                                disabled={!unlockTags}
                                                            />
                                                        </label>
                                                        <label className="block">
                                                            Tag de Listo:
                                                            <input
                                                                type="text"
                                                                value={variants[activeVariant].readyTag}
                                                                onChange={(e) => updateVariant(activeVariant, 'readyTag', e.target.value)}
                                                                className={`mt-1 block w-full p-2 rounded text-white ${unlockTags ? 'bg-gray-700' : 'bg-red-700 cursor-not-allowed'}`}
                                                                disabled={!unlockTags}
                                                            />
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>

                                {/* Pestaña Avanzado */}
                                <div className={`tab-content ${activeTab === 'advanced' ? 'active' : ''}`}>
                                    <div className="bg-gray-800 rounded-lg shadow-lg p-6">
                                        <h2 className="text-2xl font-semibold mb-4">Configuración Avanzada</h2>
                                        {showWarnings && (
                                            <div className="bg-yellow-900 text-yellow-200 p-3 rounded mb-4">
                                                <p className="text-sm">
                                                    ⚠️ Este comando se ejecutará cada tick para todas las variantes. Añade solo si sabes lo que haces.
                                                </p>
                                            </div>
                                        )}
                                        <textarea
                                            value={advancedCommand}
                                            onChange={(e) => setAdvancedCommand(e.target.value)}
                                            className="w-full h-40 p-3 bg-gray-700 rounded text-white font-mono text-sm"
                                            placeholder="Comando personalizado (se ejecuta cada tick)"
                                        />
                                    </div>
                                </div>

                                {/* Pestaña Instrucciones */}
                                <div className={`tab-content ${activeTab === 'instructions' ? 'active' : ''}`}>
                                    <div className="bg-gray-800 rounded-lg shadow-lg p-6">
                                        <h2 className="text-2xl font-semibold mb-4">Instrucciones para Usar el Datapack</h2>
                                        <div className="space-y-4 text-gray-300">
                                            <div className="bg-gray-700 p-4 rounded">
                                                <h3 className="font-semibold text-lg mb-2">1. Descarga el archivo</h3>
                                                <p>Haz clic en "Finalizar y Descargar Datapack" para obtener el archivo <code className="bg-gray-600 px-1 py-0.5 rounded">tick.mcfunction</code>.</p>
                                            </div>
                                            
                                            <div className="bg-gray-700 p-4 rounded">
                                                <h3 className="font-semibold text-lg mb-2">2. Estructura del datapack</h3>
                                                <p>Crea la siguiente estructura de carpetas en tu mundo de Minecraft:</p>
                                                <pre className="bg-gray-600 p-2 rounded mt-2 overflow-x-auto">
{`world/
  datapacks/
    nombre_del_datapack/
      data/
        nombre_del_datapack/
          functions/
            tick.mcfunction
      pack.mcmeta`}</pre>
                                            </div>
                                            
                                            <div className="bg-gray-700 p-4 rounded">
                                                <h3 className="font-semibold text-lg mb-2">3. Contenido de pack.mcmeta</h3>
                                                <p>Crea el archivo <code className="bg-gray-600 px-1 py-0.5 rounded">pack.mcmeta</code> con este contenido:</p>
                                                <pre className="bg-gray-600 p-2 rounded mt-2 overflow-x-auto">
{`{
  "pack": {
    "pack_format": 6,
    "description": "Datapack de variantes de mobs personalizado"
  }
}`}</pre>
                                            </div>
                                            
                                            <div className="bg-gray-700 p-4 rounded">
                                                <h3 className="font-semibold text-lg mb-2">4. Activar el datapack</h3>
                                                <p>En el juego, ejecuta el comando <code className="bg-gray-600 px-1 py-0.5 rounded">/reload</code> para cargar el datapack.</p>
                                                <p className="mt-2">El datapack se ejecutará automáticamente cada tick, aplicando las configuraciones a los mobs.</p>
                                            </div>
                                            
                                            <div className="bg-gray-700 p-4 rounded">
                                                <h3 className="font-semibold text-lg mb-2">Nota importante</h3>
                                                <p>Los items con CustomModelData:100 se eliminan automáticamente al dropearse para evitar acumulación en el mundo.</p>
                                                <p className="mt-2">Para los creepers, los efectos se aplicarán continuamente cada tick para mantenerlos incluso después de explotar, mientras que la armadura y items solo se aplican una vez.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Botón de descarga */}
                    <div className="mt-8 text-center">
                        <button
                            onClick={generateDatapack}
                            className="px-8 py-3 bg-gradient-to-r from-green-500 to-blue-500 rounded-lg hover:from-green-600 hover:to-blue-600 text-lg font-semibold shadow-lg transition-all transform hover:scale-105"
                        >
                            Finalizar y Descargar Datapack
                        </button>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
